

SQL> -- test out misuse of star * with function
SQL> ---- test out normal functions, common path function path with no specified star eligibility
SQL> select abs(*);

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select acos(*);

OG-00601, [1:13]Sql syntax error: unexcpected '*'
SQL> ---- test out window function with star as parameter, expecting window reject star as any parameter, except count(*), prepare table for use
SQL> DROP TABLE IF EXISTS test_winsort_function_with_star_1;

Succeed.

SQL> DROP TABLE IF EXISTS test_winsort_function_with_star_2;

Succeed.

SQL> create table test_winsort_function_with_star_1 (a int);

Succeed.

SQL> create table test_winsort_function_with_star_2 (a int, b int);

Succeed.

SQL> insert into test_winsort_function_with_star_1 values(1), (2);

2 rows affected.

SQL> insert into test_winsort_function_with_star_2 values(1, 2), (2, 3);

2 rows affected.

SQL> ------ test aggregate function (not windowed version) with star in parameter, expecting reject 
SQL> select sum(*) from test_winsort_function_with_star_1;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select sum(*) from test_winsort_function_with_star_2;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select COVAR_POP(*, a) from test_winsort_function_with_star_2;

OG-00601, [1:18]Sql syntax error: unexcpected '*'
SQL> select COVAR_POP(a, *) from test_winsort_function_with_star_2;

OG-00601, [1:21]Sql syntax error: unexcpected '*'
SQL> select min(*) from test_winsort_function_with_star_1;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select min(*) from test_winsort_function_with_star_2;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select stddev(*) from test_winsort_function_with_star_1;

OG-00601, [1:15]Sql syntax error: unexcpected '*'
SQL> select approx_count_distinct(*) from test_winsort_function_with_star_1;

OG-00601, [1:30]Sql syntax error: unexcpected '*'
SQL> select lnnvl(*) from test_winsort_function_with_star_2;

OG-00601, [1:14]Sql syntax error: unexcpected '*'
SQL> ------ test aggregate function (windowed version) with star in parameter, expecting reject 
SQL> select sum(*) over() from test_winsort_function_with_star_1;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select sum(*) over() from test_winsort_function_with_star_2;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select sum(*) over(PARTITION BY a) from test_winsort_function_with_star_2;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select COVAR_POP(*, a) over() from test_winsort_function_with_star_2;

OG-00601, [1:18]Sql syntax error: unexcpected '*'
SQL> select COVAR_POP(*, a) over(PARTITION BY a) from test_winsort_function_with_star_2;

OG-00601, [1:18]Sql syntax error: unexcpected '*'
SQL> select COVAR_POP(*, a) over(PARTITION BY b) from test_winsort_function_with_star_2;

OG-00601, [1:18]Sql syntax error: unexcpected '*'
SQL> select min(*) over() from test_winsort_function_with_star_1;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select min(*) over(PARTITION BY a) from test_winsort_function_with_star_2;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select listagg(*, 'x') within group (order by b) from test_winsort_function_with_star_1;

OG-00601, [1:16]Sql syntax error: unexcpected '*'
SQL> select listagg(*, 'y') within group (order by b) from test_winsort_function_with_star_2;

OG-00601, [1:16]Sql syntax error: unexcpected '*'
SQL> select b, lag(*, 1) over(order by a) from test_winsort_function_with_star_2;

OG-00601, [1:15]Sql syntax error: unexcpected '*'
SQL> select b, lag(*, 1) over(PARTITION BY b order by a) from test_winsort_function_with_star_2;

OG-00601, [1:15]Sql syntax error: unexcpected '*'
SQL> select a, lag(*, 1) over(PARTITION BY b order by a) from test_winsort_function_with_star_2;

OG-00601, [1:15]Sql syntax error: unexcpected '*'
SQL> select ntile(*) over (ORDER BY a) FROM test_winsort_function_with_star_2;

OG-00601, [1:14]Sql syntax error: unexcpected '*'
SQL> select avg(*) over () from test_winsort_function_with_star_1;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select avg(*) over (PARTITION BY a) from test_winsort_function_with_star_1;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select avg(*) over (PARTITION BY a) from test_winsort_function_with_star_2;

OG-00601, [1:12]Sql syntax error: unexcpected '*'
SQL> select cume_dist(*, 1) within group (order by a) from test_winsort_function_with_star_1;

OG-00601, [1:18]Sql syntax error: unexcpected '*'
SQL> select stddev(*) over() from test_winsort_function_with_star_1;

OG-00601, [1:15]Sql syntax error: unexcpected '*'
SQL> select stddev(*) over() from test_winsort_function_with_star_2;

OG-00601, [1:15]Sql syntax error: unexcpected '*'
SQL> select dense_rank(*, 1) within group (order by a) FROM test_winsort_function_with_star_2;

OG-00601, [1:19]Sql syntax error: unexcpected '*'
SQL> -- accept count(*) use
SQL> select count(*) from test_winsort_function_with_star_1;

COUNT(*)            
--------------------
2                   

1 rows fetched.

SQL> select count(*) over() from test_winsort_function_with_star_2;

COUNT(*) OVER()     
--------------------
2                   
2                   

2 rows fetched.

SQL> select count(*) over(PARTITION BY a) from test_winsort_function_with_star_2;

COUNT(*) OVER(PARTITION BY A)
-----------------------------
1                            
1                            

2 rows fetched.

SQL> DROP TABLE IF EXISTS test_winsort_function_with_star_1;

Succeed.

SQL> DROP TABLE IF EXISTS test_winsort_function_with_star_2;

Succeed.

SQL> 
SQL> drop table if exists test_part_for_1;

Succeed.

SQL> create table test_part_for_1 (id int, value int)
  2 partition by range (id) (
  3     partition p1 values less than (100),
  4     partition p2 values less than (200),
  5     partition p3 values less than (300),
  6     partition p4 values less than (maxvalue)
  7 );

Succeed.

SQL> select * from test_part_for_1 partition for (max(1));

OG-01317, [1:46]Unexpected aggregation 'MAX'
SQL> select * from test_part_for_1 partition for (id);

OG-00601, [1:46]Sql syntax error: invalid column name 'ID'
SQL> select * from test_part_for_1 partition for (prior id);

OG-00601, [1:46]Sql syntax error: 'prior' operator not allowed here
SQL> select * from test_part_for_1 partition for (rownum);

OG-00601, [1:46]Sql syntax error: unexpected rownum occurs
SQL> select * from test_part_for_1 partition for (rowid);

OG-00601, [1:46]Sql syntax error: unexpected rowid occurs
SQL> select * from test_part_for_1 partition for (default);

OG-00601, [1:46]Sql syntax error: unexpected DEFAULT occurs
SQL> select * from test_part_for_1 partition for (rowscn);

OG-00601, [1:46]Sql syntax error: unexpected rowscn occurs
SQL> select * from test_part_for_1 partition for (rownodeid);

OG-00101, Capability: reserved word not in list not supported
SQL> select * from test_part_for_1 partition for (maxvalue);

OG-00601, [1:46]Sql syntax error: invalid column name 'MAXVALUE'
SQL> select * from test_part_for_1 partition for (cast(rowid as number));

OG-00601, [1:51]Sql syntax error: unexpected rowid occurs
SQL> select * from test_part_for_1 partition for (*);

OG-00601, [1:46]Sql syntax error: unexcpected '*'
SQL> select * from test_part_for_1 partition for (count(1) over());

OG-01316, [1:55]Unexpected windows sort analytic function
SQL> select * from test_part_for_1 partition for ((select count(*) from test_part_for_1));

ID           VALUE       
------------ ------------

0 rows fetched.

SQL> select * from test_part_for_1 partition for (1 + rownum);

OG-00601, [1:50]Sql syntax error: unexpected rownum occurs
SQL> select * from test_part_for_1 partition for (1 + 1);

ID           VALUE       
------------ ------------

0 rows fetched.

SQL> drop table if exists test_part_for_1;
Succeed.





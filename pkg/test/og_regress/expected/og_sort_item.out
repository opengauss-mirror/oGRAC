

SQL> -- test distinct + order by if_func core
SQL> drop table if exists t_order_by_if_func;

Succeed.

SQL> create table t_order_by_if_func(f1 int, f2 int, f3 int);

Succeed.

SQL> insert into t_order_by_if_func values (null, 4, 5),(8, 9, 10),(1, 2, 3);

3 rows affected.

SQL> commit;

Succeed.

SQL> select distinct f1, f2, f3 from t_order_by_if_func order by if(f1 is null, f2, f3);

F1           F2           F3          
------------ ------------ ------------
1            2            3           
             4            5           
8            9            10          

3 rows fetched.

SQL> select distinct f1, f2 from t_order_by_if_func order by f3; -- excepted error

OG-00601, [1:57]Sql syntax error: expression not in distinct list
SQL> drop table if exists t_order_by_if_func;

Succeed.

SQL> 
SQL> DROP TABLE IF EXISTS test_connect_by_root_1;

Succeed.

SQL> DROP TABLE IF EXISTS test_connect_by_root_2;

Succeed.

SQL> DROP TABLE IF EXISTS test_connect_by_root_3;

Succeed.

SQL> create table test_connect_by_root_1(id int);

Succeed.

SQL> create table test_connect_by_root_2(id int);

Succeed.

SQL> create table test_connect_by_root_3(conect_by_rootc1 int, c2 int);

Succeed.

SQL> insert into test_connect_by_root_1 values (1),(2),(3);

3 rows affected.

SQL> insert into test_connect_by_root_2 values (2),(3),(4);

3 rows affected.

SQL> insert into test_connect_by_root_3 values (1,1),(2,2),(2,2),(3,3);

4 rows affected.

SQL> commit;

Succeed.

SQL> select connect_by_root id, id from test_connect_by_root_1 connect by id > prior id order by 1,2;

ID           ID          
------------ ------------
1            1           
1            2           
1            3           
1            3           
2            2           
2            3           
3            3           

7 rows fetched.

SQL> select id, connect_by_root id from test_connect_by_root_1 connect by id > prior id order by 1,2;

ID           ID          
------------ ------------
1            1           
2            1           
2            2           
3            1           
3            1           
3            2           
3            3           

7 rows fetched.

SQL> select connect_by_root id, id from test_connect_by_root_1 connect by id > prior id
  2 union all
  3 select connect_by_root id, id from test_connect_by_root_1 connect by id > prior id order by 1,2;

ID           ID          
------------ ------------
1            1           
1            1           
1            2           
1            2           
1            3           
1            3           
1            3           
1            3           
2            2           
2            2           
2            3           
2            3           
3            3           
3            3           

14 rows fetched.

SQL> select id, connect_by_root id from test_connect_by_root_1 connect by id > prior id
  2 union all
  3 select id, connect_by_root id from test_connect_by_root_1 connect by id > prior id order  by 1,2;

ID           ID          
------------ ------------
1            1           
1            1           
2            1           
2            1           
2            2           
2            2           
3            1           
3            1           
3            1           
3            1           
3            2           
3            2           
3            3           
3            3           

14 rows fetched.

SQL> DROP TABLE IF EXISTS test_connect_by_root_1;

Succeed.

SQL> DROP TABLE IF EXISTS test_connect_by_root_2;

Succeed.

SQL> DROP TABLE IF EXISTS test_connect_by_root_3;
Succeed.







SQL> drop table if exists tab_pivot;

Succeed.

SQL> create table tab_pivot(c_id int, c_pay number(12,3));

Succeed.

SQL> 
SQL> insert into tab_pivot values(19, .137458);

1 rows affected.

SQL> insert into tab_pivot values(1, null);

1 rows affected.

SQL> insert into tab_pivot values(8, .137458);

1 rows affected.

SQL> insert into tab_pivot values(8, .137458);

1 rows affected.

SQL> insert into tab_pivot values(24, .137458);

1 rows affected.

SQL> insert into tab_pivot values(44, .137458);

1 rows affected.

SQL> commit;

Succeed.

SQL> 
SQL> SELECT * FROM tab_pivot
  2 PIVOT(COUNT(DISTINCT c_pay) as AGGR_0 FOR (c_id) IN ((8) AS PEXPR_0));

PEXPR_0_AGGR_0      
--------------------
1                   

1 rows fetched.

SQL> 
SQL> CREATE TABLE T1(TID VARCHAR(100 BYTE) NOT NULL,TNAME VARCHAR(256 BYTE),"PROCESSDEFKEY" VARCHAR(256 BYTE),ENDTIME DATE,EXECSEQUENCENUM NUMBER,OUTPUT CHAR(1 BYTE),FORMURL VARCHAR(512 BYTE));

Succeed.

SQL> 
SQL> INSERT INTO T1 VALUES('105#','tiantiankaixin','TD_211','2020-07-14 02:02:22',2,'1','/flag');

1 rows affected.

SQL> 
SQL> SELECT *
  2 FROM T1
  3 PIVOT (
  4   MAX(CAST('2020-02-24 12:18:22' AS TIMESTAMP WITH TIME ZONE)) AS A0,
  5   LISTAGG(DISTINCT CAST(NULL AS TIMESTAMP))
  6     WITHIN GROUP(ORDER BY T1.ENDTIME DESC NULLS FIRST) AS A1
  7   FOR (EXECSEQUENCENUM, OUTPUT)
  8   IN ((5, '0') AS PEXPR_0)
  9 );
TID                                                              TNAME                                                            PROCESSDEFKEY                                                    FORMURL                                                          PEXPR_0_A0                               PEXPR_0_A1                                                      
---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------------------------------- ---------------------------------------- ----------------------------------------------------------------
105#                                                             tiantiankaixin                                                   TD_211                                                           /flag                                                                                                                                                                     

1 rows fetched.




